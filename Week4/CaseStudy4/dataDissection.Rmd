---
title: "Case Study 4"
author: "Logan Morrill"
date: "9/14/2021"
output: 
  html_document:
    theme: united
    keep_md: True
    code_folding: 'hide'
---


```{r Packages, include = FALSE}
# Load Packages
library(nycflights13)
library(tidyverse)
```
##### Load Data
```{r Load Data}
flightData <- tibble(flights)
head(flightData)
str(flightData)

```
### Which origin airport is best to minimize my chances of a late arrival when I am using Delta Airlines?

```{r Best departure airport}
?flights
head(airlines)

best_delta_arrival_flights <- flightData %>%
  select(carrier, year:day, arr_delay, origin) %>%
  group_by(origin) %>%
  filter(carrier == "DL") %>%
  arrange(arr_delay)
head(best_delta_arrival_flights)

#Find out the name of the best airport for arrival
?airports
airports %>%
  select(faa, name) %>%
  filter(faa == "JFK")
```
John F Kennedy International is the best airport to depart from to minimize arrival delay on Delta Airline flights.

### Which destination airport is the worst airport for arrival time?
```{r Worst airport for arrival}
worst_airport_delayed_arrival <- flightData %>%
  group_by(origin) %>%
  summarise(
    avg_arrival_delay = mean(arr_delay, na.rm = TRUE))
head(worst_airport_delayed_arrival)

#Find out the name of the worst airport for arrival
?airports
airports %>%
  select(faa, name) %>%
  filter(faa == "EWR")
```
Newark Liberty International it the worst airport for arrival time with an average delay of 9.1 minutes.
### Graphs
```{r Worst airport graph }
ggplot(data = flightData, aes(x = origin, y = arr_delay)) +
  geom_point(aes(color = origin)) +
  geom_point(data = worst_airport_delayed_arrival, aes(y = avg_arrival_delay, color = 'red', size = 1)) +
  annotate("text", x = c(1.1,2.1,3.1), y = 30, label = c("9.107", "5.551", "5.783")) +
  xlab("Airport") + ylab("Arrival Delay (minutes)") +
  theme(axis.text.x = element_text(color = "grey20", size = 13),
        axis.text.y = element_text(color = "grey20", size = 13),  
        axis.title.x = element_text(size = 16),
        axis.title.y = element_text(size = 16),
        legend.position = 'none')
```

